!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).Page=e()}(this,function(){"use strict";var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function f(t){return void 0===t}var t=function(){var t=function(){function t(){this._eventHandler={},this.options={}}var e=t.prototype;return e.trigger=function(t,e){void 0===e&&(e={});var n=this._eventHandler[t]||[];if(!(0<n.length))return!0;n=n.concat(),e.eventType=t;var r=!1,i=[e],o=0;e.stop=function(){r=!0},e.currentTarget=this;for(var s=arguments.length,f=new Array(2<s?s-2:0),a=2;a<s;a++)f[a-2]=arguments[a];for(1<=f.length&&(i=i.concat(f)),o=0;n[o];o++)n[o].apply(this,i);return!r},e.once=function(i,o){if("object"==typeof i&&f(o)){var t,e=i;for(t in e)this.once(t,e[t]);return this}if("string"==typeof i&&"function"==typeof o){var s=this;this.on(i,function t(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];o.apply(s,n),s.off(i,t)})}return this},e.hasOn=function(t){return!!this._eventHandler[t]},e.on=function(t,e){if("object"==typeof t&&f(e)){var n,r=t;for(n in r)this.on(n,r[n]);return this}if("string"==typeof t&&"function"==typeof e){var i=this._eventHandler[t];f(i)&&(this._eventHandler[t]=[],i=this._eventHandler[t]),i.push(e)}return this},e.off=function(t,e){if(f(t))return this._eventHandler={},this;if(f(e)){if("string"==typeof t)return this._eventHandler[t]=void 0,this;var n,r=t;for(n in r)this.off(n,r[n]);return this}var i,o,s=this._eventHandler[t];if(s)for(i=0;void 0!==(o=s[i]);i++)if(o===e){s=s.splice(i,1);break}return this},t}();return t.VERSION="2.1.2",t}(),a="object",e="undefined",c=typeof document!==e&&document;function u(t){return Array.isArray(t)}var o=0;function i(){window.innerWidth,o=window.innerHeight}window.addEventListener("resize",i),i();var s=function(f){function i(t,e){void 0===e&&(e={});var n,r,i,o=f.call(this)||this;if(o.ranges={},o._range=[0,"100%"],o.margin=[0,0],o.pages=[],o.state={enter:!1,firstEnter:!1,firstExit:!1},o.scroll=function(){o.onCheck()},o.resize=function(){o.onCheck()},o.el=t?(i=t)&&typeof i===a?t:(n=t,r?c.querySelectorAll(n):c.querySelector(n)):null,"range"in e&&(o._range=e.range),"margin"in e){var s=e.margin;u(s)?o.margin=s:o.margin=[s,s]}return"events"in e&&e.events.forEach(function(t){"resize"===t?window.addEventListener("resize",o.resize):"scroll"===t?window.addEventListener("scroll",o.scroll):o.el&&o.el.addEventListener(t,o.scroll)}),o}n(i,f);var t=i.prototype;return t.add=function(t){return this.pages.push(t),this},t.range=function(t){void 0===t&&(t=[0,"100%"]);var e=u(t)?t:[t,t],n="["+e.join(",")+"]";if(this.ranges[n])return this.ranges[n];var r=new i(this.el,{range:e});return this.ranges[n]=r,this.add(r),r},t.triggerEvent=function(t){this.trigger(t,{target:this.el})},t.onEnter=function(e){var n=this,t=this.state;t.enter||(t.enter=!0,t.firstEnter||(t.firstEnter=!0,this.triggerEvent("firstEnter")),this.triggerEvent("enter")),this.pages.forEach(function(t){t.onCheck(t.el===n.el?e:void 0)})},t.onExit=function(){var t=this.state;t.enter&&(t.enter=!1,t.firstExit||(t.firstExit=!0,this.triggerEvent("firstExit")),this.triggerEvent("exit")),this.pages.forEach(function(t){t.onExit()})},t.calcSize=function(t,e){if("number"==typeof t)return t;var n=t.match(/("[^"]*")|('[^']*')|([^\s()]*(?:\((?:[^()]*|\([^()]*\))*\))[^\s()]*)|\S+/g)||[];if(!n)return 0;for(var r=n.length,i=[],o=1,s=0;s<r;++s){var f=n[s];"+"===f?o=1:"-"===f?o=-1:"*"===f?(i.push((i.pop()||0)*this._calcSize(n[s+1],e)),++s):"/"===f?(i.push((i.pop()||0)/this._calcSize(n[s+1],e)),++s):(i.push(o*this._calcSize(f,e)),o=1)}return i.reduce(function(t,e){return t+e},0)},t.getRect=function(t){var e=this.el?this.el.getBoundingClientRect():void 0;if(e)return{top:e.top+(t?document.body.scrollTop||document.documentElement.scrollTop:0),height:e.height}},t.onCheck=function(t){if(void 0===t&&(t=this.getRect()),t){var e=t.top,n=this.calcSize(this._range[0],t),r=this.calcSize(this._range[1],t),i=this.calcSize(this.margin[0],t);e+r+this.calcSize(this.margin[1],t)<=0||o<=e+n-i?this.onExit():this.onEnter(t)}else this.pages.forEach(function(t){t.onCheck()})},t._calcSize=function(t,e){if(!t)return 0;if("number"==typeof t)return t;if("window"===t)return o;if(-1<t.indexOf("("))return this.calcSize((n=t,r=/([^(]*)\(([\s\S]*)\)([\s\S]*)/g.exec(n),!r||r.length<4?{}:{prefix:r[1],value:r[2],suffix:r[3]}).value,e);var n,r,i=function(t){var e=/^([^\d|e|\-|\+]*)((?:\d|\.|-|e-|e\+)+)(\S*)$/g.exec(t);if(!e)return{prefix:"",unit:"",value:NaN};var n=e[1],r=e[2];return{prefix:n,unit:e[3],value:parseFloat(r)}}(t);return"%"===i.unit?e.height*i.value/100:i.value},i}(t),h=function(e){function t(t){return void 0===t&&(t={}),e.call(this,void 0,t)||this}return n(t,e),t}(s);return s.s=h,s});
//# sourceMappingURL=page.min.js.map
